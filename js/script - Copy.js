var yearInterval="",africaColor="#00D5E9",asiaColor="#FF5872",australiaColor="#2E86C1",cenAmeColor="#16A085",europeColor="#E67E22",norAmeColor="#7E5109",oceanicColor="#922B21",souAmeColor="#A569BD",colorFlag=1,allYears=[1900,1910,1920,1930,1940,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016],yearIndex=0;$(document).ready(function(){function t(t){return t.Year==c}function a(){var a=dataset.filter(t),n=s.selectAll("circle").data(a,function(t){return t.Country});n.transition().duration(300).ease(d3.easeBounce).attr("cx",function(t){return d(t.GDP)}).attr("cy",function(t){return u(t.LifeExp)}).attr("r",function(t){return 1.25*p(t.Population)}).style("stroke","black").style("fill",function(t){var a=t.Region;return"Africa"==a?africaColor:"Asia"==a?asiaColor:"Australia"==a?australiaColor:"Central America"==a?cenAmeColor:"Europe"==a?europeColor:"North America"==a?norAmeColor:"Oceanic"==a?oceanicColor:"South America"==a?souAmeColor:void 0}),n.enter().append("circle").attr("cx",function(t){return d(t.GDP)}).attr("cy",function(t){return u(t.LifeExp)}).attr("r",function(t){return p(t.Population)}).on("mouseover",function(t){y.transition().duration(200).style("opacity",.9),y.html(t.Country+"<br/>√èncome:"+t.GDP+"<br/> Life Expectency:"+t.LifeExp).style("left",d(t.GDP)+"px").style("top",u(t.LifeExp)+"px")}).on("mouseout",function(t){y.transition().duration(500).style("opacity",0)}).style("stroke","black").style("fill",function(t){var a=t.Region;return"Africa"==a?africaColor:"Asia"==a?asiaColor:"Australia"==a?australiaColor:"Central America"==a?cenAmeColor:"Europe"==a?europeColor:"North America"==a?norAmeColor:"Oceanic"==a?oceanicColor:"South America"==a?souAmeColor:void 0}),n.exit().remove(),d3.select("#year_header").text("Year: "+c),d3.select("#yearText").text(c),e(a),r(a)}function e(t){var a=d3.nest().key(function(t){return t.Region}).rollup(function(t){return d3.sum(t,function(t){return 1})}).entries(t),e=C.selectAll("rect").data(a,function(t){return t.Region});e.append("rect").attr("x",1).attr("y",function(t){return g(t.key)}).attr("height",g.bandwidth()-2).attr("width",function(t){return x(+t.value)}).attr("fill","blue"),e.enter().append("rect").attr("x",1).attr("y",function(t){return g(t.key)}).attr("height",g.bandwidth()-2).attr("width",function(t){return x(+t.value)}).attr("fill","blue"),e.exit().remove()}function r(t){var a=d3.nest().key(function(t){return t.Government}).rollup(function(t){return d3.sum(t,function(t){return 1})}).entries(t),e=A.selectAll("rect").data(a,function(t){return t.Government});e.append("rect").attr("x",1).attr("y",function(t){return P(t.key)}).attr("height",P.bandwidth()-2).attr("width",function(t){return E(+t.value)}).attr("fill","blue"),e.enter().append("rect").attr("x",1).attr("y",function(t){return P(t.key)}).attr("height",P.bandwidth()-2).attr("width",function(t){return E(+t.value)}).attr("fill","blue"),e.exit().remove()}function n(){0==colorFlag?(africaColor="#00D5E9",asiaColor="#FF5872",australiaColor="#2E86C1",cenAmeColor="#16A085",europeColor="#E67E22",norAmeColor="#7E5109",oceanicColor="#922B21",souAmeColor="#A569BD",colorFlag=1,a(),$("#colorChange").text("Colorblind Eyes")):(africaColor="#66C2A5",asiaColor="#FC8D62",australiaColor="#8DA0CB",cenAmeColor="#E78AC3",europeColor="#A6D854",norAmeColor="#FFD92F",oceanicColor="#E5C494",souAmeColor="#B3B3B3",colorFlag=0,a(),$("#colorChange").text("Normal Eyes"))}var o={top:10,right:10,bottom:40,left:25},l=900-o.left-o.right,i=500-o.top-o.bottom,c=allYears[0],s=d3.select("#mainCanvas").append("svg").attr("width",l+o.left+o.right).attr("height",i+o.top+o.bottom).append("g").attr("transform","translate(40,10)"),u=d3.scaleLinear().range([i,0]),d=d3.scaleLinear().rangeRound([0,80,160,240,320,400,480,560,640,720,800]).domain([0,500,1e3,2e3,4e3,8e3,16e3,32e3,64e3,128e3,256e3]),p=d3.scaleLinear().range([1,25]),f=d3.axisLeft().scale(u).ticks(5),m=d3.axisBottom().scale(d).ticks(5).tickFormat(function(t){return t/1e3>=1&&(t=t/1e3+"K"),t}).tickValues([0,500,1e3,2e3,4e3,8e3,16e3,32e3,64e3,128e3,256e3]),y=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),C=d3.select("#rightCanvasOne").append("svg").attr("width",350).attr("height",249).append("g").attr("transform","translate(110,10)"),x=d3.scaleLinear().domain([0,55]).range([0,220]),g=d3.scaleBand().range([200,0]),v=d3.axisBottom().scale(x).ticks(5),h=d3.axisLeft().scale(g),A=d3.select("#rightCanvasTwo").append("svg").attr("width",350).attr("height",249).append("g").attr("transform","translate(110,10)"),E=d3.scaleLinear().domain([0,130]).range([0,220]),P=d3.scaleBand().range([200,0]),k=d3.axisBottom().scale(E).ticks(5),b=d3.axisLeft().scale(P);d3.csv("./data/Gapminder_All_Time.csv",function(t,e){if(t)console.log("Something went wrong"),console.log(t);else{console.log("Data Loaded"),dataset=e,dataset.forEach(function(t){t.Year=+t.Year,t.Population=+t.Population,t.LifeExp=+t.LifeExp,t.GDP=+t.GDP,t.Area=+t.Area,t.Coastline=+t.Coastline});d3.max(dataset,function(t){return t.GDP}),d3.max(dataset,function(t){return t.LifeExp});var r=d3.max(dataset,function(t){return t.Population}),n=d3.min(dataset,function(t){return t.Population});u.domain([15,90]),g.domain(dataset.map(function(t){return t.Region})),P.domain(dataset.map(function(t){return t.Government})),p.domain([n,r]),s.append("g").attr("class","grid").attr("id","x-axis").attr("transform","translate(0,"+i+")").call(m),s.append("g").attr("class","grid").attr("id","y-axis").call(f),C.append("g").attr("class","axis").attr("transform","translate(0,200)").call(v),C.append("g").attr("class","axis").call(h),A.append("g").attr("class","axis").attr("transform","translate(0,200)").call(k),A.append("g").attr("class","axis").call(b),a()}}),$("#showData").click(function(){display_var=$("#textYear").val(),display_var=parseInt(display_var),allYears.includes(display_var)?(c=+display_var,yearIndex=allYears.indexOf(display_var),a()):alert("Enter year between: 1910, 1920, 1930, 1940, 1950 and 2016")}),$("#playPause").click(function(){"Play"==$("#playPause").text()?($("#playPause").text("Pause"),yearIndex>71&&(c=allYears[yearIndex=0]),a(),yearInterval=setInterval(function(){c=allYears[yearIndex],(yearIndex+=1)>71&&($("#playPause").text("Play"),clearInterval(yearInterval)),a()},100)):"Pause"==$("#playPause").text()&&($("#playPause").text("Play"),clearInterval(yearInterval))}),$("#colorChange").click(function(){n()})});